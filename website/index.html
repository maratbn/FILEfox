<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
    <head>
        <style type='text/css'>
            .FILEfox_support {
                font-family:                    sans-serif;
                font-size:                      10pt;
                width:                          90%;
                margin:                         auto;
            }
            .FILEfox_support .FILEfox_quick_links {
                float:                          right;
                margin-left:                    15px;
                width:                          19%;
            }
            .FILEfox_support .FILEfox_quick_links .wooff {
                font-weight:                    bold;
            }
            .FILEfox_support .section_content {
                margin-left:                    20px;
                margin-right:                   20px;
            }
            .FILEfox_support .section_content .file_contents_container {
                background-color:               #ffff77;
                border:                         1px solid blue;
                line-height:                    16px;
                min-height:                     50px;
                max-height:                     200px;
                overflow:                       auto;
            }
            .FILEfox_support .section_content .code {
                color:                          #3366ff;
            }
            .FILEfox_support .section_content .code .code_op {
                color:                          black;
                font-weight:                    bold;
            }
            .FILEfox_support .section_content .item_desc {
                margin-left:                    10px;
                margin-right:                   10px;
            }
            .FILEfox_support .documentation .section_content h1,
            .FILEfox_support .documentation .section_content h2,
            .FILEfox_support .documentation .section_content h3,
            .FILEfox_support .documentation .section_content h4,
            .FILEfox_support .documentation .section_content h5,
            .FILEfox_support .documentation .section_content h6,
            .FILEfox_support .documentation .section_content h7,
            .FILEfox_support .documentation .section_content h8 {
                margin:                         0;
            }
            .FILEfox_support .documentation .section_content p {
                margin:                         0px 0px 10px 0px;
            }
            .FILEfox_support .documentation .section_content li {
                list-style-type:                none;
            }
            .FILEfox_support .disclaimer {
                /*
                width:                          80%;
                */
            }
            .FILEfox_support .error {
                /*
                color:                          red;
                */
            }
        </style>
        <title>Welcome to the FILEfox Firefox extension support website</title>
        <script type='text/javascript' src='http://68.168.213.10/FILEfox/testXSSdetection.js'></script>
    </head>
    <body class='FILEfox_support'>
        <div class='FILEfox_quick_links'>
            <h3><a href='FILEfox.xpi'>Install FILEfox extension version 0.1</a></h3>
            <p class='wooff'>
                (Works only on <a href='http://www.getfirefox.com/'>Firefox</a>)
                <br>
            </p>
            <p>
                <h3><a href='http://github.com/maratbn/FILEfox'>Browse source</a></h3>
            </p>
        </div>
        <h1>Welcome to the FILEfox Firefox extension support website.</h1>
        <ul>
            <li class='background'>
                <h3>Background:</h3>
                <div class='section_content'>
                    <p>
                        FILEfox is an open-source <a href='http://addons.mozilla.org/'>add-on / extension module</a>
                        for the popular open-source <a href='http://www.mozilla.org/'>Mozilla</a> <a href='http://www.mozilla.com/firefox/'>Firefox</a> web browser.
                    </p>
                    <p>
                        FILEfox is a local file access proxy for JavaScript-based web applications running on Firefox.
                        It gives these applications a civilized way to request manual user permission to load specific
                        local files for local analysis, in a fashion similar to the HTML form file upload, but the
                        data does not have to be uploaded to the web server.  This eliminates the age-old requirement
                        that the user data resides on remote server(s), enabling better privacy, and further opening
                        the door to desktop computing via web applications.
                    </p>
                    <p>
                        FILEfox remains dormant until a web application requests permission to load a file.
                        The request is relayed to the user, who can approve or deny.
                        FILEfox notifies the user when the request is coming through 3-rd party JavaScript.
                        Permission can be granted to load only one file at a time, and each file is loaded only at the time the permission is granted.
                    </p>
                </div>
            </li>
            <li class='tester'>
                <h3>Test FILEfox in your browser:</h3>
                <div class='section_content'>
                    <script type='text/javascript'>
                        // <!--
                        function TextFileView() {
                            var CONST_marginBottom      = 30;
                            var CONST_heightLine        = 16;

                            var text_fileDisplaying     = null;         //  !!  IMPORTANT
                                                                        //  !!
                                                                        //  !!  The object containing the file contents is kept in a private local variable
                                                                        //  !!  to prevent other scripts on this page from accessing the file contents.
                            var lineRendered            = null;
                            var totalHeight             = 0;

                            function _processHugeNumberInsertCommas(number) {
                                var strNumber = number.toFixed(0).toString();
                                var strProcessed = "";
                                for (var i = 0; i < strNumber.length; i++) {
                                    if (i > 0 && i % 3 == 0) strProcessed = ',' + strProcessed;
                                    strProcessed = strNumber[strNumber.length - 1 - i] + strProcessed;
                                }
                                return strProcessed;
                            }

                            this.displayTextFile = function(text_fileDisplay) {
                                lineRendered = null;

                                text_fileDisplaying = text_fileDisplay;

                                var spanStatus = document.getElementById('status');
                                spanStatus.innerHTML = "Total Lines: " + _processHugeNumberInsertCommas(text_fileDisplay.totalLines) + "  Total Characters: " + _processHugeNumberInsertCommas(text_fileDisplay.totalChars);

                                // Scroll the viewport back to the top for the new file:
                                var divOutput = document.getElementById('output');
                                divOutput.scrollTop = 0;

                                // Figure out what the height of the viewport should be with the new file:
                                totalHeight = text_fileDisplay.totalLines * CONST_heightLine + CONST_marginBottom;

                                // Set the new viewport height:
                                var divOutputScrolling = document.getElementById('output_scrolling');
                                divOutputScrolling.style.height = totalHeight + 'px';
                            },

                            this.timer = function() {
                                var divOutput = document.getElementById('output');
                                if (divOutput) {
                                    if (text_fileDisplaying) {
                                        var lineStart = Math.floor(divOutput.scrollTop / CONST_heightLine);
                                        var heightLinePortion = divOutput.scrollTop % CONST_heightLine;

                                        var preOutputText = document.getElementById('output_text');
                                        preOutputText.style.top = (divOutput.scrollTop - heightLinePortion) + "px";

                                        if (lineStart != lineRendered) {
                                            var lineEnd = lineStart + 20;
                                            var arrText = [];
                                            for (var i = lineStart; i < lineEnd && i < text_fileDisplaying.totalLines; i++) {
                                                arrText.push(text_fileDisplaying.getLine(i));
                                            }
                                            while (preOutputText.firstChild) {
                                                preOutputText.removeChild(preOutputText.firstChild);
                                            }
                                            preOutputText.appendChild(document.createTextNode(arrText.join("")));
                                            lineRendered = lineStart;
                                        }
                                    }
                                }

                                setTimeout('text_file_view.timer()', 250);
                            }

                            this.timer();
                        }

                        var text_file_view = new TextFileView();

                        function doLoadFile() {
                            var text_file = window.nsFILEfox.requestLoadASCIIFile(
                                                    "FILEfox demo site",
                                                    "This is the FILEfox demonstration website.  Specify an ASCII text file with test data to experience the file loading process via the FILEfox extension.");
                            if (!text_file) {
                                alert("Demonstration website:  Could not get a file via the FILEfox Firefox extension.  The user has either canceled, or there was an error in some part of the loading process.");
                                return;
                            }

                            text_file_view.displayTextFile(text_file);
                        }

                        if (window.nsFILEfox) {
                            document.writeln("<p>");
                            document.writeln("You have the FILEfox extension version ", window.nsFILEfox.getVersion(), " installed and enabled.");
                            document.writeln("</p>");
                            document.writeln("<p>");
                            document.writeln("You can <a href='#' onClick='doLoadFile()'>test-load</a> an ASCII text file off your hard drive into the area below:");
                            document.writeln("</p>");
                            document.writeln("<p>");
                            document.writeln("(You can also <a href='#' onClick='doLoadFileViaXSS()'>test</a> the FILEfox <a href='http://en.wikipedia.org/wiki/Cross-site_scripting'>3-rd party JavaScript / cross-site scripting (XSS)</a> detection security feature.)");
                            document.writeln("</p>");
                            document.writeln("<p>");
                            document.writeln("<span id='status'></span>");
                            document.writeln("</p>");
                            document.writeln("<div id='output' class='file_contents_container'>");
                            document.writeln(   "<div id='output_scrolling' style='position:relative'>");
                            document.writeln(       "<pre id='output_text' style='position:absolute;margin:0;'><div style='color:#777777;margin:13px 23px 0px 23px;'>Loaded text file displays here...</p></div>");
                            document.writeln(   "</div>");
                            document.writeln("</div>");
                            document.writeln("<br>");
                        } else {
                            if (navigator && navigator.userAgent.match(/Firefox/)) {
                                document.writeln("You do NOT currently have the FILEfox extension installed, or it is explicitly disabled.");
                            } else {
                                document.writeln(
                                            [
                                                "<span class='error'>",
                                                    "Firefox web browser not detected.  This feature currently works only on the Firefox web browser.  ",
                                                    "Please view this page with the Firefox web browser.",
                                                "</span>"
                                            ].join(""));
                            }
                        }
                        
                        // -->
                    </script>
                    <noscript>
                        <span class='error'>
                            JavaScript support not detected.  This feature requires JavaScript support, and it currently works only on the Firefox web browser.
                            Please view this page with the Firefox web browser, and with the JavaScript support enabled.
                        </span>
                    </noscript>
                </div>
            </li>
            <li class='documentation'>
                <h3>FILEfox API Documentation:</h3>
                <div class='section_content'>
                    <p>
                        The FILEfox extension makes itself available to every website loaded in the browser DOM via the global '<span class='code'>nsFILEfox'</span> object.
                        The '<span class='code'>nsFILEfox</span>' object is an XPCOM component conforming to the XPCOM interface '<span class='code'>nsIFILEfox</span>'.
                        <p>
                            Methods:
                            <ul>
                                <li>
                                    <h5 class='code'>String getVersion<span class='code_op'>()</span></h5>
                                    <div class='item_desc'>
                                        <p>
                                            Returns the version of the currently installed FILEfox extension.
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    <h5 class='code'>nsIFILEfoxTextFileRead requestLoadASCIIFile<span class='code_op'>(</span>String strMessageToUser<span class='code_op'>)</span></h5>
                                    <div class='item_desc'>
                                        <p>
                                            Causes the FILEfox extension to request from the user to manually select an ASCII text file to load.  Upon
                                            user approval FILEfox will initiate a Mozilla-internal synchroneous file loading routine via XPCOM, and then
                                            return the file contents in a data object corresponding to the '<span class='code'>nsIFILEfoxTextFileRead</span>' interface, or a falsy
                                            value on failure.
                                            <br><br>
                                            The returned data object should be assigned to a private local variable inside the calling function and later
                                            accessed via closure to prevent exposing it to other scripts on the page.
                                            <p>
                                                Parameters:
                                                <ul>
                                                    <li>
                                                        <h6 class='code'>String strApplicationName</h6>
                                                        <p class='item_desc'>
                                                            A short textual name identifying the JavaScript
                                                            application requesting the file.  The application will be
                                                            identified to the user by this name.
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <h6 class='code'>String strMessageToUser</h6>
                                                        <p class='item_desc'>
                                                            A longer textual request message providing file loading
                                                            instructions to the user, and explaining why the
                                                            JavaScript application is requesting the file.
                                                        </p>
                                                    </li>
                                                </ul>
                                            </p>
                                        </p>
                                    </div>
                                </li>
                            </ul>
                        </p>
                    </p>
                    <p>
                        The anonymous '<span class='code'>nsIFILEfox<span class='code_op'>.</span>TextFileRead</span>' object returned by the method
                        '<span class='code'>nsFILEfox<span class='code_op'>.</span>requestLoadASCIIFile<span class='code_op'>(...)</span></span>' contains the contents of the text file loaded.
                        <p>
                            Properties:
                            <ul>
                                <li>
                                    <h5 class='code'>String encoding</h5>
                                    <div class='item_desc'>
                                        <p>
                                            The encoding with which this text file is encoded.
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    <h5 class='code'>Number totalLines</h5>
                                    <div class='item_desc'>
                                        <p>
                                            Total number of lines in the text file.
                                        </p>
                                        <p>
                                            The text file is stored line by line rather than in a single string, as otherwise a huge file in a huge string 
                                            would overwhelm the browser's JavaScript engine.
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    <h5 class='code'>Number totalChars</h5>
                                    <div class='item_desc'>
                                        <p>
                                            Total number of characters in the text file.
                                        </p>
                                    </div>
                                </li>
                            </ul>
                            Methods:
                            <ul>
                                <li>
                                    <h5 class='code'>String getLine<span class='code_op'>(</span>Number indexLine<span class='code_op'>)</span></h5>
                                    <div class='item_desc'>
                                        <p>
                                            Returns a single line out of the text file, including the line termination carriage return character sequence.
                                            <p>
                                                Parameters:
                                                <ul>
                                                    <li>
                                                        <h6 class='code'>Number indexLine</h6>
                                                        <p class='item_desc'>
                                                            0-based index of the line.
                                                        </p>
                                                    </li>
                                                </ul>
                                            </p>
                                        </p>
                                    </div>
                                </li>
                            </ul>
                        </p>
                    </p>
                </div>
            </li>
            <li class='disclaimer'>
                <h3>Disclaimer:</h3>
                <div class='section_content'>
                    <p>
                        WARNING:  MALICIOUS WEB APPLICATIONS MAY UPLOAD ANY DATA AVAILABLE TO MALICIOUS SERVERS.
                        <ul>
                            <li>USE THIS EXTENSION ONLY WITH THE WEBSITES YOU TRUST.</li>
                            <li>DO NOT USE THIS EXTENSION TO OPEN FILES FOR PHISHING WEBSITES.</li>
                            <li>DO NOT USE THIS EXTENSION TO OPEN FILES FOR WEBSITES THAT ALLOW ARBITRARY 3-RD PARTY JAVASCRIPT APPLICATIONS (SUCH AS FACEBOOK).</li>
                            <li>DO NOT USE THIS EXTENSION TO OPEN FILES CONTAINING DATA SUCH AS AUTHENTICATION, OPERATING SYSTEM CONFIGURATION, OR FINANCIAL INFORMATION.</li>
                        </ul>
                    </p>
                    
                    <p>
                        ** RECOMMENDED FOR EXPERIENCED USERS ONLY **
                    </p>
                </div>
            </li>
        </ul>
        <div class='footer'>
            Copyright (c) 2010 Marat Nepomnyashy
            <br>
            Except where otherwise noted, this webpage is licensed under the
            <a href='http://creativecommons.org/licenses/by-sa/3.0/'>Creative Commons Attribution Share-Alike License version 3</a>.
        </div>
    </body>
</html>